<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pagos Seguros | ThermoProcess</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <link href="public/css/style.css" rel="stylesheet">
  <style>
    /* ===== ESTILOS PLIN RESPONSIVE ===== */
    .plin-verification {
      background: #f8f9fa;
      padding: 2rem;
      border-radius: 10px;
      margin: 1rem 0;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .verification-card {
      max-width: 500px;
      margin: 0 auto;
      padding: 1.5rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    }

    .verification-steps {
      text-align: left;
      margin: 1.5rem 0;
      padding-left: 1.5rem;
    }

    .verification-steps li {
      margin-bottom: 0.8rem;
      color: #555;
    }

    .verification-form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    #verification-email {
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s;
    }

    #verification-email:focus {
      border-color: #2A5C8B;
      box-shadow: 0 0 0 3px rgba(42,92,139,0.2);
    }

    #verify-btn {
      background: #2A5C8B;
      color: white;
      border: none;
      padding: 14px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
    }

    #verify-btn:hover {
      background: #1E4566;
    }

    .verification-message {
      padding: 12px;
      border-radius: 8px;
      margin-top: 1rem;
      display: none;
      animation: fadeIn 0.5s;
    }

    .message-success {
      background: #e6ffed;
      color: #1a7f37;
      border: 1px solid #a7f3b0;
    }

    .message-error {
      background: #ffebee;
      color: #d32f2f;
      border: 1px solid #ffcdd2;
    }

    .register-link {
      display: inline-block;
      margin-top: 1.5rem;
      color: #2A5C8B;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s;
    }

    .register-link:hover {
      text-decoration: underline;
    }

    /* Animaciones */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Responsive para móviles */
    @media (max-width: 768px) {
      .plin-verification {
        padding: 1.5rem;
        margin: 0.5rem 0;
      }
      
      .verification-card {
        padding: 1.2rem;
        box-shadow: none;
      }
      
      #verify-btn {
        padding: 16px;
      }
      
      .verification-steps {
        padding-left: 1rem;
      }
    }

    /* Estilos para la sección de pago */
    #plin-payment-section {
      display: none; /* Oculto inicialmente */
      animation: fadeIn 0.5s;
    }
    
    .qr-instructions {
      margin-bottom: 1.5rem;
    }
    
    .qr-container {
      max-width: 300px;
      margin: 0 auto 1.5rem;
      padding: 1rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    }
    
    .qr-container img {
      width: 100%;
      height: auto;
      display: block;
    }
    
    .payment-details {
      background: #f8f9fa;
      padding: 1.2rem;
      border-radius: 8px;
      margin-top: 1.5rem;
    }
  </style>
</head>
<body>
  <!-- Header (Mantén tu header existente) -->
  <header>...</header>

  <!-- Contenido principal -->
  <main class="payment-container">
    <!-- ... (Mantén tus secciones de selección de curso y pestañas) ... -->

    <!-- Sección PLIN Mejorada -->
    <div id="plin-tab" class="tab-content">
      <div id="plin-content" class="plin-content">
        <!-- Tarjeta de verificación -->
        <div id="plin-verification" class="plin-verification">
          <div class="verification-card">
            <h3 style="margin-bottom: 1rem; color: #2A5C8B;">Verifica tu registro</h3>
            <p style="color: #555; margin-bottom: 1.5rem;">Para pagar con PLIN debes haber completado nuestro formulario de contacto.</p>
            
            <ol class="verification-steps">
              <li>Completa el <strong>formulario de registro</strong></li>
              <li>Ingresa aquí el mismo email que usaste</li>
              <li>Verifica tu identidad</li>
            </ol>
            
            <div class="verification-form">
              <input type="email" id="verification-email" placeholder="tucorreo@ejemplo.com">
              <button id="verify-btn">Verificar ahora</button>
              <div id="verification-message" class="verification-message"></div>
            </div>
            
            <a href="formularios.html" class="register-link">¿No te has registrado? Haz clic aquí</a>
          </div>
        </div>
        
        <!-- Sección de pago (aparece tras verificación) -->
        <div id="plin-payment-section">
          <div class="qr-instructions">
            <h3 style="margin-bottom: 1rem; color: #2A5C8B;">Paga con PLIN fácilmente</h3>
            <ol style="padding-left: 1.5rem;">
              <li>Abre la app <strong>PLIN</strong> en tu celular</li>
              <li>Selecciona la opción <strong>"Pagar con QR"</strong></li>
              <li>Escanea este código e ingresa el monto exacto</li>
            </ol>
          </div>
          
          <div class="qr-container">
            <img src="public/img/plin-qr.jpeg" alt="Código QR PLIN">
          </div>
          
          <div class="payment-details">
            <p><strong>Beneficiario:</strong> OSCAR DEL CARPIO</p>
            <p><strong>Monto a ingresar:</strong> <span id="plin-amount">$100.00</span> USD</p>
            <p><strong>Concepto:</strong> <span id="plin-concept">Curso Básico</span></p>
          </div>
          
          <div style="margin-top: 1.5rem; padding: 1rem; background: #fff3cd; border-radius: 8px;">
            <p style="margin: 0; color: #856404;">⚠️ <strong>Importante:</strong> El monto debe coincidir exactamente con tu compra.</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer (Mantén tu footer existente) -->
  <footer>...</footer>

  <script>
    // ===== VERIFICACIÓN CON FORMULARIO =====
    const verifyBtn = document.getElementById('verify-btn');
    const emailInput = document.getElementById('verification-email');
    const messageDiv = document.getElementById('verification-message');
    const plinVerification = document.getElementById('plin-verification');
    const plinPaymentSection = document.getElementById('plin-payment-section');

    // Simulación de base de datos (en producción usa tu backend)
    const registeredEmails = [
      'cliente@ejemplo.com', 
      'usuario@test.com',
      'correo@registrado.com'
    ];

    verifyBtn.addEventListener('click', verifyRegistration);

    function verifyRegistration() {
      const email = emailInput.value.trim().toLowerCase();
      resetMessages();

      if (!email) {
        showMessage('Por favor ingresa tu email', 'message-error');
        emailInput.focus();
        return;
      }

      if (!isValidEmail(email)) {
        showMessage('El formato del email no es válido', 'message-error');
        return;
      }

      // Simulación de verificación (reemplazar con API real)
      setTimeout(() => {
        if (registeredEmails.includes(email)) {
          successfulVerification(email);
        } else {
          showMessage('Email no registrado. Completa el formulario primero.', 'message-error');
        }
      }, 800);
    }

    function successfulVerification(email) {
      showMessage('✅ Verificación exitosa. Redirigiendo...', 'message-success');
      
      // Guardar en localStorage (simulación de sesión)
      localStorage.setItem('verifiedUser', email);
      
      // Transición suave
      setTimeout(() => {
        plinVerification.style.display = 'none';
        plinPaymentSection.style.display = 'block';
        updatePlinDetails();
      }, 1500);
    }

    function isValidEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    function showMessage(text, className) {
      messageDiv.textContent = text;
      messageDiv.className = `verification-message ${className}`;
      messageDiv.style.display = 'block';
    }

    function resetMessages() {
      messageDiv.style.display = 'none';
      messageDiv.className = 'verification-message';
    }

    // ===== RESTRICCIÓN POR PESTAÑA =====
    document.querySelector('[data-tab="plin-tab"]').addEventListener('click', function() {
      if (!localStorage.getItem('verifiedUser')) {
        // Mueve el scroll a la sección de verificación
        plinVerification.scrollIntoView({ behavior: 'smooth' });
        
        // Efecto visual para llamar la atención
        plinVerification.style.animation = 'none';
        void plinVerification.offsetWidth; // Trigger reflow
        plinVerification.style.animation = 'pulse 1.5s';
      }
    });

    // Efecto de pulso (añade al CSS)
    const style = document.createElement('style');
    style.textContent = `
      @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(42, 92, 139, 0.4); }
        70% { box-shadow: 0 0 0 15px rgba(42, 92, 139, 0); }
        100% { box-shadow: 0 0 0 0 rgba(42, 92, 139, 0); }
      }
    `;
    document.head.appendChild(style);

    // ===== INICIALIZACIÓN =====
    document.addEventListener('DOMContentLoaded', function() {
      // Verificar si ya está autenticado
      if (localStorage.getItem('verifiedUser')) {
        plinVerification.style.display = 'none';
        plinPaymentSection.style.display = 'block';
      }
      
      // Actualizar detalles al cambiar curso
      document.getElementById('producto').addEventListener('change', updatePlinDetails);
    });

    function updatePlinDetails() {
      const producto = document.getElementById('producto');
      const monto = producto.value;
      const curso = producto.options[producto.selectedIndex].text.split(' - ')[0];
      
      document.getElementById('plin-amount').textContent = `$${monto}`;
      document.getElementById('plin-concept').textContent = curso;
    }
  </script>
</body>
</html>